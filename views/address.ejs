<%- include('partials/header') %>


<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Success</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <h4 id="message"><b></b></h4>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="modalclose" data-dismiss="modal" >OK</button>
      </div>
      </div>
      </div>
</div>



  <nav class="  nav_col navbar navbar-expand-lg  ">
    <a class="navbar-brand" href="#" style="color:white;">Welcome,<span id="fname"><%=user.name%></span> </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="nav navbar-nav ml-auto">
        <a href="/cart" style="padding:15px; color:white;"<i class="fas fa-cart-plus xl"><%=count_of_products%>Cart</a>
        <a> <img width="20" href="/myprofile" height="20" src="/uploads/<%=user.imagename%>" style="margin-top: 10px;width: 40px;border-left-width: 10px;height: 30px;margin-bottom: 10px;" alt="">
        </a>

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="color:white;">
            Account
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
            <a class="dropdown-item" href="/myprofile"><i class="fa fa-user" aria-hidden="true"></i>My Profile</a>
            <a class="dropdown-item" href="/address">Address</a>
              <a class="dropdown-item" href="/dashboard">Dashboard</a>
            <a class="dropdown-item" href="/Logout">Logout</a>
          </div>
        </li>
      </ul>
    </div>
  </nav>

  <!-- <div class="pricing-column col-sm-6  "style="padding:5px;"> -->
      <!-- <div class="card content ">
        <div class="card-body"> -->
          <button type="button" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#exampleModal" style="width:15%;margin-top:40px;margin-left:30px;">
            <i class="fas fa-plus  "></i>  Add new address
          </button>
          <!-- </div>
          </div> -->
 <!-- </div> -->
<!-- Button trigger modal -->


<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add Address</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="row">
          <form  class="form-group">
            <div   class="row required">
              <input  type="text" name="name" id="name" class="form__input form-control  star " placeholder="Full Name(Required)*" required/>
   <p> aditya</p>
            </div>
            <div class="row required">
              <input type="text" name="number" minlength="10" maxlength="10"  id="number" class="form__input form-control star" placeholder="Phone-No(Required)*" required/>
           </div>
           <div class="row required">
             <select name="state" id="state" class="form__input form-control  star " placeholder="Select State" style="padding-top:0px;">
<option value="Select State">Select State</option>
   <option value="Andhra Pradesh">Andhra Pradesh</option>
   <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
   <option value="Arunachal Pradesh">Arunachal Pradesh</option>
   <option value="Assam">Assam</option>
   <option value="Bihar">Bihar</option>
   <option value="Chandigarh">Chandigarh</option>
   <option value="Chhattisgarh">Chhattisgarh</option>
   <option value="Dadar and Nagar Haveli">Dadar and Nagar Haveli</option>
   <option value="Daman and Diu">Daman and Diu</option>
   <option value="Delhi">Delhi</option>
   <option value="Lakshadweep">Lakshadweep</option>
   <option value="Puducherry">Puducherry</option>
   <option value="Goa">Goa</option>
   <option value="Gujarat">Gujarat</option>
   <option value="Haryana">Haryana</option>
   <option value="Himachal Pradesh">Himachal Pradesh</option>
   <option value="Jammu and Kashmir">Jammu and Kashmir</option>
   <option value="Jharkhand">Jharkhand</option>
   <option value="Karnataka">Karnataka</option>
   <option value="Kerala">Kerala</option>
   <option value="Madhya Pradesh">Madhya Pradesh</option>
   <option value="Maharashtra">Maharashtra</option>
   <option value="Manipur">Manipur</option>
   <option value="Meghalaya">Meghalaya</option>
   <option value="Mizoram">Mizoram</option>
   <option value="Nagaland">Nagaland</option>
   <option value="Odisha">Odisha</option>
   <option value="Punjab">Punjab</option>
   <option value="Rajasthan">Rajasthan</option>
   <option value="Sikkim">Sikkim</option>
   <option value="Tamil Nadu">Tamil Nadu</option>
   <option value="Telangana">Telangana</option>
   <option value="Tripura">Tripura</option>
   <option value="Uttar Pradesh">Uttar Pradesh</option>
   <option value="Uttarakhand">Uttarakhand</option>
   <option value="West Bengal">West Bengal</option>
   </select>
           </div>
           <div class="row required">
             <input type="number" name="pincode" id="pincode" class="form__input form-control star " placeholder="Pincode(Required)*" required/>
          </div>
           <div class="row required">
             <input type="text" name="city" id="city" class="form__input form-control star " placeholder="City(Required)* " required/>
          </div>

          <div class="row required">
            <input type="text" name="address" id="address" class="form__input form-control star" placeholder="Full Address(Required)*"required/>
          </div>


          </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
       <button type="button" id="savebtn" onclick="save();" class="btn btn-dark">Save</button>
       <!-- <a  onclick="save();" class="btn btn-dark">Save</a> -->
      </div>
    </div>
  </div>
  </div>





  <!-- Modal  EDIT-->
  <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Edit Address</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="row "style="padding-left:60px;">
            <form  class="form-group">
              <div   class="row required">
                <input  type="text" name="name" id="name1" value="" class="form__input form-control  star" placeholder"="fullname"/>
              </div>
              <div class="row required">
                <input type="text" name="number" minlength="10" maxlength="10" id="number1" class="form__input form-control star" placeholder="Phone-No(Required)*"/>
             </div>
             <div class="row required">
               <select name="state" id="state1" class="form__input form-control  star " placeholder="Select State" style="padding-top:0px;padding-left:0px;">
              <option value="Select State">Select State</option>
            <option value="Andhra Pradesh">Andhra Pradesh</option>
            <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
            <option value="Arunachal Pradesh">Arunachal Pradesh</option>
            <option value="Assam">Assam</option>
            <option value="Bihar">Bihar</option>
            <option value="Chandigarh">Chandigarh</option>
            <option value="Chhattisgarh">Chhattisgarh</option>
            <option value="Dadar and Nagar Haveli">Dadar and Nagar Haveli</option>
            <option value="Daman and Diu">Daman and Diu</option>
            <option value="Delhi">Delhi</option>
            <option value="Lakshadweep">Lakshadweep</option>
            <option value="Puducherry">Puducherry</option>
            <option value="Goa">Goa</option>
            <option value="Gujarat">Gujarat</option>
            <option value="Haryana">Haryana</option>
            <option value="Himachal Pradesh">Himachal Pradesh</option>
            <option value="Jammu and Kashmir">Jammu and Kashmir</option>
            <option value="Jharkhand">Jharkhand</option>
            <option value="Karnataka">Karnataka</option>
            <option value="Kerala">Kerala</option>
            <option value="Madhya Pradesh">Madhya Pradesh</option>
            <option value="Maharashtra">Maharashtra</option>
            <option value="Manipur">Manipur</option>
            <option value="Meghalaya">Meghalaya</option>
            <option value="Mizoram">Mizoram</option>
            <option value="Nagaland">Nagaland</option>
            <option value="Odisha">Odisha</option>
            <option value="Punjab">Punjab</option>
            <option value="Rajasthan">Rajasthan</option>
            <option value="Sikkim">Sikkim</option>
            <option value="Tamil Nadu">Tamil Nadu</option>
            <option value="Telangana">Telangana</option>
            <option value="Tripura">Tripura</option>
            <option value="Uttar Pradesh">Uttar Pradesh</option>
            <option value="Uttarakhand">Uttarakhand</option>
            <option value="West Bengal">West Bengal</option>
            </select>
             </div>
              <div class="row required">

                <input type="number" name="pincode" id="pincode1" class="form__input form-control star "  placeholder="Pincode(Required)*"/>



             </div>

             <div class="row required">
               <input type="text" name="city" id="city1" class="form__input form-control star "  placeholder="City(Required)* "/>
            </div>

            <div class="row required">
              <input type="text" name="address" id="address1" class="form__input form-control star" placeholder="Full Address(Required)*"/>
            </div>


            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
         <!-- <button type="submit"   onclick="edit();" class="btn btn-dark">Update</button> -->
                <a href="/address" onclick="edit();" class="btn btn-dark">Update</a>
        </div>
      </div>
    </div>
    </div>

  <section id="cardid" class="cards">
  <br>
  <!-- <h3  class="content" style="margin-top:10px;margin-right:10px;margin-left:20px;">Category</h3> -->
  <br>
        <div style ="margin-top:10px;margin-right:10px;margin-left:10px;"class="row">

          <% for(var c of address){ %>
          <div class="col-md-12"style="padding-bottom:5px; width:530px;">
            <div class="card content shadow p-2 mb-5 bg-white rounded" style=" width:560px">

              <div class="card-body">

                <a href="/delete_address" style="margin-left:440px;"class="far fa-trash-alt ">Remove</a>
                <a  href="" class="" data-toggle="modal" data-target="#editModal" style="margin-left:440px;"id="editbtn" data-id="<%= c._id %>" ><i class="fas fa-edit"></i>Edit</a>



                <h5 class="price-text"><%=c.fullname%>,<%=c.phone_no%></h5>
                <p><%=c.address%>,<strong><%=c.city%>,<%=c.state%>,<%=c.pincode%></strong></p>
              </div>
            </div>
          </div>
          <% } %>
          </div>



      </section>

<script type="text/javascript">



  function phoneno(){


        var number = document.getElementById("number").value;
        if(number.length!=10){
            document.getElementById('exampleModalCenter').style.zIndex = 1055;
        msg1.innerHTML = "Number must be 10 digit ";
        document.getElementById("number").style.border="solid 1px red";
        document.getElementById("modalclose").style.color="red";

        $('#exampleModalCenter').modal();

        return false;
      }
      else if( /^\d+$/.test(number)==false){
          document.getElementById('exampleModalCenter').style.zIndex = 1055;
        msg1.innerHTML = "Phone Number can Only Contain Digits ";
        document.getElementById("number").style.border="solid 1px red";
        document.getElementById("modalclose").style.color="red";

        $('#exampleModalCenter').modal();

        return false;
      }



   return true;
 }



            function required(){
                document.getElementById("exampleModalLongTitle").innerHTML="Alert!!";
                document.getElementById("exampleModalLongTitle").style.color ="Red";
                console.log("require");
                msg1 = document.getElementById("message");
                msg1.style.color="red";
                //var form = document.getElementById('name').value;
                errors1=[];
                var name= document.getElementById("name").value;
                var number = document.getElementById("number").value;
                var city = document.getElementById("city").value;
                var state=document.getElementById("state").value;
                var pincode=document.getElementById("pincode").value;
                var address = document.getElementById("address").value;


                if(name==""){
                  errors1.push("Please Enter Your Full Name.<br>");
                    document.getElementById("name").style.border="solid 1px red";
                }
               if (number=="") {
                   errors1.push("Please Enter Your Phone Number.<br>");
                     document.getElementById("number").style.border="solid 1px red";
                }
                if (state=="") {
                      errors1.push("Please Enter Your Email.<br>" );
                        document.getElementById("city").style.border="solid 1px red";
                  }
              if (city=="") {
                    errors1.push("Please Enter Your Email.<br>" );
                      document.getElementById("city").style.border="solid 1px red";
                }
                if (pincode=="") {
                      errors1.push("Please Enter Your Password.<br>");
                      document.getElementById("pincode").style.border="solid 1px red";

                  }
                  if (address=="") {
                        errors1.push("Please Enter Your Password.<br>");
                        document.getElementById("address").style.border="solid 1px red";
                    }


                  if (errors1.length > 0) {
                    document.getElementById('exampleModalCenter').style.zIndex = 1055;
                    msg1.innerHTML = "All fields are mandatory ";
                    document.getElementById("modalclose").style.color="red";

                    $('#exampleModalCenter').modal();



                    return false;
                  }

                return true;
              }

              function required_edit(){
                  document.getElementById("exampleModalLongTitle").innerHTML="Alert!!";
                  document.getElementById("exampleModalLongTitle").style.color ="Red";
                  console.log("require");
                  msg1 = document.getElementById("message");
                  msg1.style.color="red";
                  //var form = document.getElementById('name').value;
                  errors1=[];
                  var name= document.getElementById("name1").value;
                  var number = document.getElementById("number1").value;
                  var city = document.getElementById("city1").value;
                  var state=document.getElementById("state1").value;
                  var pincode=document.getElementById("pincode1").value;
                  var address = document.getElementById("address1").value;


                  if(name==""){
                    errors1.push("Please Enter Your Full Name.<br>");
                      document.getElementById("name").style.border="solid 1px red";
                  }
                 if (number=="") {
                     errors1.push("Please Enter Your Phone Number.<br>");
                       document.getElementById("number").style.border="solid 1px red";
                  }
                  if (state=="") {
                        errors1.push("Please Enter Your Email.<br>" );
                          document.getElementById("city").style.border="solid 1px red";
                    }
                if (city=="") {
                      errors1.push("Please Enter Your Email.<br>" );
                        document.getElementById("city").style.border="solid 1px red";
                  }
                  if (pincode=="") {
                        errors1.push("Please Enter Your Password.<br>");
                        document.getElementById("pincode").style.border="solid 1px red";

                    }
                    if (address=="") {
                          errors1.push("Please Enter Your Password.<br>");
                          document.getElementById("address").style.border="solid 1px red";
                      }


                    if (errors1.length > 0) {
                      document.getElementById('exampleModalCenter').style.zIndex = 1055;
                      msg1.innerHTML = "All fields are mandatory ";
                      document.getElementById("modalclose").style.color="red";

                      $('#exampleModalCenter').modal();



                      return false;
                    }

                  return true;
                }




  function save(){
    console.log("save");
var data = {};
msg = document.getElementById("message");
closebtn = document.getElementById('modalclose');
data.name= document.getElementById("name").value;
data.number = document.getElementById("number").value;
data.city = document.getElementById("city").value;
data.state= document.getElementById("state").value;
data.pincode=document.getElementById("pincode").value;
data.address = document.getElementById("address").value;
var y=required()
if(y==false){
  return;
}
var a=phoneno()
{
  if(a==false)
  return;
}
$.ajax({
    type: 'POST',
    data: data,
    url: '/address',
    success: function(returns){


         if(returns){
                window.location.href = "/address";
                // location.reload();

         }
     else{
          }
      }

  });
}
$(document).on("click", "#editbtn", function () {

  console.log("edit");
  var data = {};
  btn = document.getElementById("editbtn");
  console.log($(this));
  data.address_id = $(this).data("id");
  console.log(data);
$.ajax({
  type: 'POST',
  data: data,
  url: '/address_by_id',
  success: function(address){

     if(address){
       console.log(address);
      document.getElementById("name1").value=address.fullname;
     document.getElementById("number1").value=address.phone_no;
       document.getElementById("state1").value=address.state;
       document.getElementById("city1").value=address.city;
       document.getElementById("pincode1").value=address.pincode;
     document.getElementById("address1").value=address.address;


     }


      else{

        }
  }
});


});



  function edit(){
    console.log("save");
var data = {};
data.name= document.getElementById("name1").value;
data.number = document.getElementById("number1").value;
data.city = document.getElementById("city1").value;
data.state= document.getElementById("state1").value;
data.pincode=document.getElementById("pincode1").value;
data.address = document.getElementById("address1").value;

var y=required()
if(y==false){
  return;
}

  $.ajax({
    type: 'POST',
    data: data,
    url: '/update-address',
    success: function(returns){

       if(returns){
         document.getElementById("savebtn").onclick = function () {
    res.redirect("/address");
    };

       }


        else{
          document.getElementById("savebtn").onclick = function () {

     }
          }
    }
  });
}

  </script>



<%- include('partials/footer') %>
